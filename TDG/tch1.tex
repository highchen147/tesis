\chapter{ECUACIONES DE CONSERVACIÓN Y SISTEMAS HIPERBÓLICOS DE PRIMER ORDEN}
En este capítulo se introducen los conceptos fundamentales de las ecuaciones de conservación y sistemas hiperbólicos de primer orden. Se introduce el problema de Riemann asociado a una ecuación de conservación.
\section{Ecuaciones de conservación}
En física, una ecuación de conservación es una ecuación diferencial parcial de la siguiente forma
\begin{equation}
	\pdv{\mathbf{U}}{t} + \pdv{\mathbf{F}(\mathbf{U})}{x} = 0
	\label{eq:conservacion}
\end{equation}
o utilizando una notación más compacta para las derivadas,
\begin{equation}
	\mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = 0
	\label{eq:conserv-deriv-short}
\end{equation}
donde $\mathbf{U}$ es un vector n-dimensional de variables físicas que se conservan, por ejemplo, la densidad, la masa o el momentum de un medio \cite{Leveque}. En este texto, las variables de las que depende $\mathbf{U}$ dependen de $x$ y $t$, una variable espacial y otra temporal respectivamente. Por tanto, $\mathbf{U}$ se define formalmente como $\mathbf{U} : \mathbb{R} \times  \mathbb{R} \rightarrow \mathbb{R}^{n}$, mientras que la i-ésima variable conservada se denomina $u_{i}$, de tal manera que $\mathbf{U} = \mathbf{U}(u_{1}, u_{2}, \dots, u_{n})$\hspace{2mm}\cite{Leveque}. 

La función $\mathbf{F}$ corresponde al \textbf{flujo} de cada una de las variables involucradas en un punto $(x,t)$ \cite{Leveque}. Al igual que $\mathbf{U}$, la función $\mathbf{F}$ depende de las mismas variables físicas y por ende, también depende de $(x,t)$. Sin embargo, el flujo de cada variable conservada puede tener una forma distinta, entonces es conveniente escribir a $\mathbf{F}$ como un vector de $n$ funciones independientes, $\mathbf{F} = (f_{1}, f_{2}, \dots, f_{n})$
de tal manera que $f_i$ es la función de flujo de la i-ésima variable conservada, $u_i$ \cite{Leveque}.

Una ecuación de conservación para un sistema definido en un intervalo espacial $D = [a,b]$ necesita de condiciones iniciales para su resolución, el caso más simple a considerar es el de un problema de Cauchy \cite{Leveque}. En dicho caso, se debe especificar una función $\mathbf{U}_0(x)$
\begin{equation}
	\mathbf{U}(x,0) = \mathbf{U}_0(x)
\end{equation} 
la cual sea válida para todo $x$ tal que $x \in D$ y condiciones de frontera
\begin{equation}
	\mathbf{U}(a,t) = \mathbf{U}_{a}
\end{equation}
\begin{equation}
	\mathbf{U}(b,t) = \mathbf{U}_{b}
\end{equation}
con $\mathbf{U}_{a}$ y $\mathbf{U}_{b}$ fijos.

Otra forma de escribir una ecuación de conservación es utilizando la matriz jacobiana $\mathbf{A(\mathbf{U})}$ definida como
\begin{equation}
	\mathbf{A(\mathbf{U})} \equiv
	\begin{bmatrix}
		\pdv{f_1}{u_1} & \dots & \pdv{f_1}{u_n} \\
		\vdots & \ddots & \vdots \\
		\pdv{f_n}{u_1} & \dots & \pdv{f_n}{u_n} \\
	\end{bmatrix}
\end{equation}
de tal manera que la ecuación (\ref{eq:conservacion}) se convierte en
\begin{equation}
	\mathbf{U}_{t} + \mathbf{A(\mathbf{U})}\mathbf{U}_{x} = 0
	\label{eq:conservacion-jacobiana}
\end{equation}.
Esta forma de escribir una ecuación de conservación es relevante ya que permite definir un \textbf{sistema hiperbólico}. Un sistema hiperbólico es una ecuación de conservación de la forma (\ref{eq:conservacion-jacobiana}) tal que los autovalores de la matriz $\mathbf{A(\mathbf{U})}$ para todo $\mathbf{U}$ sean reales y que dicha matriz sea diagonalizable \cite{Leveque}. Esto implica que existen $n$ vectores propios linealmente independientes de $\mathbf{A(\mathbf{U})}$ \cite{Leveque}.
Una ecuación de conservación depende de una función $\mathbf{F(\mathbf{U})}$ que, por lo general, no es una función lineal de $\mathbf{U}$, lo que implica que las ecuaciones de conservación son regularmente no lineales \cite{Leveque}. Esto también se puede inferir por la dependencia en $\mathbf{U}$ de la matriz $\mathbf{A}$ en la ecuación (\ref{eq:conservacion-jacobiana}).
\section{Derivación de una ecuación de conservación}
El principio físico de una ecuación de conservación es más explícito cuando esta se deriva a través de cantidades expresadas en forma \textbf{integral.} Considerando un ejemplo de la mecánica de fluidos, se define $M(x_1,x_2,t)$ como la cantidad de masa de un fluido que se encuentra contenido en un ``tubo'' unidimensional en un intervalo  $[x_1,x_2]$ en un tiempo $t$. Si a dicho fluido se le asocia una densidad $\rho(x,t)$, entonces esta última se define de tal manera que su integral definida en un intervalo espacial sea igual a la masa contenida en ese mismo intervalo \cite{Leveque}, i.e.,
\begin{equation}
	M(x_1, x_2, t) = \int_{x_1}^{x_2}\rho(x,t)\dd{x}.
\end{equation}
Ahora, asumiendo que el tubo es cerrado e impenetrable, la cantidad de masa en una región arbitraria $[x_1,x_2]$ puede variar solamente a causa de que el fluido se desplace (fluya) a través de los puntos límites de la región, $x_1$ y $x_2$ \cite{Leveque}. Para cuantificar el flujo que sale o entra en una región se necesita la velocidad del fluido, $v(x,t)$. Cabe destacar que debido a que el fluido se mueve en un espacio unidimensional, su velocidad se limita a dirigirse en el mismo sentido espacial, es decir, su velocidad tiene dirección sobre $x$. Entonces el flujo del fluido en un punto $(x,t)$, $F(x,t)$, se define como 
\begin{equation}
	F(x,t) = \rho(x,t)v(x,t)
\end{equation}\cite{Leveque}.
Entonces, como previamente se comentó, se puede escribir la razón instantánea de cambio de masa en la región $[x_1,x_2]$ en términos del flujo entrante y saliente de la misma región
\begin{equation}
	\dv{t}	\left[M(x_1, x_2, t)\right] = F(x_2,t) - F(x_1,t)
\end{equation}
\begin{equation}
	\dv{t}	\int_{x_1}^{x_2}\rho(x,t)\dd{x} = \rho(x_2,t)v(x_2,t) - \rho(x_1,t)v(x_1,t)
	\label{eq:continuidad-1-integral}
\end{equation}
Esta es la forma integral de una ecuación de conservación \cite{Leveque}. En particular, esta ecuación refleja el principio de conservación de la masa y a su vez es conocida como \textbf{ecuación de continuidad}. La ecuación (\ref{eq:continuidad-1-integral}) se puede integrar en el tiempo para conseguir expresarla independientemente de cualquier derivada, obteniendo
\begin{equation}
	\int_{t_1}^{t_2}\dv{t}\int_{x_1}^{x_2}\rho(x,t)\dd{x}\dd{t}  = \int_{t_1}^{t_2}\left[\rho(x_2,t)v(x_2,t) - \rho(x_1,t)v(x_1,t)\right]\dd{t}
\end{equation}
\begin{equation}
	\int_{x_1}^{x_2}[\rho(x,t_2) - \rho(x,t_1)]\dd{x}  = \int_{t_1}^{t_2}\left[\rho(x_2,t)v(x_2,t) - \rho(x_1,t)v(x_1,t)\right]\dd{t} 
	\label{eq:continuidad-2-integral}.
\end{equation}
Asumiendo que $t_1<t_2$, esta igualdad ofrece una expresión para la diferencia de masa contenida en la región $[x_1,x_2]$ entre los instantes $t_2$ y $t_1$ \cite{Leveque}. 

Es posible obtener una forma diferencial partiendo de la forma integral de una ecuación de conservación, pero es necesario asumir que las funciones $\rho(x,t)$ y $v(x,t)$ son \textbf{diferenciables}. Esta última característica que se exige en las funciones entra en conflicto cuando se estudian soluciones\footnote{Dichas soluciones se conocen como \textbf{soluciones débiles}, tema que se abordará a detalle más adelante.} de las ecuaciones de conservación con discontinuidades. Por lo tanto, la forma integral de las ecuaciones es utilizada al estudiar problemas con dichas características. Para convertir la ecuación en forma integral a su forma diferencial, se tienen que usar las siguientes expresiones:
\begin{equation}
	\rho(x,t_2)-\rho(x,t_1) = \int_{t_1}^{t_2}\pdv{t}\rho(x,t)\dd{t}
\end{equation}
y
\begin{equation}
	\rho(x_2,t)v(x_2,t)-\rho(x_1,t_1)v(x_1,t) = \int_{x_1}^{x_2}\pdv{x}\rho(x,t)v(x,t)\dd{x}
\end{equation}
sustituyendo estas expresiones en (\ref{eq:continuidad-2-integral}) se obtiene
\begin{equation}
	\int_{t_1}^{t_2}\int_{x_1}^{x_2}\left[\pdv{\rho(x,t)}{t} + \pdv{\rho(x,t)v(x,t)}{x}\right]\dd{x}\dd{t} = 0.
	\label{eq:integral-con-derivadas}
\end{equation}
Puesto que la ecuación (\ref{eq:integral-con-derivadas}) se cumple para cualquier punto $(x,t)$ del dominio, el integrando de la misma debe ser idénticamente cero \cite{Leveque}. Entonces,
\begin{equation}
	\rho_{t} + (\rho v)_{x} = 0
\end{equation}
es la forma diferencial de la ecuación de conservación de la masa, así como se definió una ecuación de conservación en (\ref{eq:conserv-deriv-short}), ya que la función de flujo se definió como $F = \rho v$. Puesto que la ecuación diferencial de conservación de la masa involucra dos cantidades físicas, esta se puede resolver ya sea si se conoce previamente la función $v(x,t)$ o si esta última se puede escribir como una función de $\rho$, i.e., $v=v(\rho)$. En este último caso la ecuación de conservación de la masa es una ecuación diferencial parcial únicamente para $\rho$ \cite{Leveque} y toma la siguiente forma
\begin{equation}
	\rho_t + f(\rho)_x = 0.
\end{equation}
Esta última es un ejemplo de \textbf{ecuación de conservación escalar} \cite{Leveque} ya que solamente interviene una incógnita, $\rho$ \cite{Leveque}.
En caso que la velocidad $v(x,t)$ sea una constante $\alpha$, la ecuación de conservación de la masa se convierte en:
\begin{equation}
	\rho_t + \alpha\rho_x = 0,
	\label{eq:adveccion}
\end{equation}
esta ecuación se conoce como \textbf{ecuación de advección lineal} o como ecuación de onda de primer orden \cite{Leveque}\cite{heattransfer}.
\section{Ecuación de advección lineal}
La ecuación de advección (\ref{eq:adveccion}) con la siguiente condición inicial:
\begin{equation}
	\rho(x,0) = \rho_0(x), \hspace{1.7cm} -\infty < x < \infty,
\end{equation}
tiene como solución:
\begin{equation}
	\rho(x,t) = \rho_0(x - \alpha t),
	\label{eq:sol-advec}
\end{equation}
para $t> 0$, asumiendo que $\rho_0$ es una función diferenciable \cite{Leveque}. Esta solución se puede interpretar como la traslación de la función $\rho_0$ a lo largo del eje $x$ con una velocidad $\alpha$, en la misma dirección de la velocidad, es decir, a la derecha si $\alpha > 0$ y a la izquierda si $\alpha < 0$.
\subsection{Curvas características}
Se puede demostrar que la solución (\ref{eq:sol-advec}) es constante respecto al tiempo a lo largo de cada curva definida por $x-\alpha t = x_0$, para cualquier $x_0$ tal que $x_0 \in [-\infty, \infty]$. Dichas curvas de la forma $x=x(t)$ son conocidas como \textbf{curvas características} de la ecuación diferencial en cuestión \cite{Leveque}. Las curvas características definen dominios en donde la ecuación diferencial parcial se puede escribir como una ecuación diferencial ordinaria. Dichas curvas se definen a partir de ecuaciones diferenciales ordinarias. En el caso de la ecuación de advección lineal (\ref{eq:sol-advec}), las características satisfacen la siguiente ecuación diferencial:
\begin{equation}
	\dv{x}{t} = \alpha, \hspace{1.7cm} x(0) = x_0,
\end{equation}
cuya solución es: $x-\alpha t = x_0$ \cite{Leveque}. Para demostrar que la ecuación de advección lineal se convierte en una ecuación diferencial ordinaria a lo largo de dichas curvas, se deriva la función incógnita $\rho$ respecto al tiempo,
\begin{equation}
	\dv{\rho}{t} = \pdv{\rho}{t} + \pdv{\rho}{x}\dv{x}{t}
\end{equation}
\begin{equation}
	\dv{\rho}{t} = \pdv{\rho}{t} + \alpha\pdv{\rho}{x}
\end{equation}
\begin{equation}
	\dv{\rho}{t} = 0,
\end{equation}
este último paso toma efecto dado que a lo largo de las curvas características, $\dv{x}{t} = \alpha$ \cite{Leveque}. Se puede notar que en este último procedimiento se recuperó la ecuación diferencial en cuestión (\ref{eq:sol-advec}), expresada como una ecuación diferencial ordinaria y concluyó al igualar la derivada temporal a cero, consiguiendo demostrar que $\rho$ es constante a lo largo de las características \cite{Leveque}.
\section{Dominio de dependencia de una ecuación de conservación}
En la sección anterior se introdujo el concepto de curvas características de una ecuación de conservación y en el caso de la ecuación de advección, es posible obtener la solución general utilizando la expresión para sus características, esto es $x(t) = x_0 + \alpha t$. Por lo tanto, se puede afirmar que el valor de $\rho(x,t)$ para un instante $(x',t')$ depende de la condición inicial $\rho_0$ únicamente en un solo punto $x'_{0}$ ya que $\rho$ es constante a lo largo de la curva característica $x' = x^{'}_{0} + \alpha t$ \cite{Leveque}. Entonces, sin importar de qué manera se cambien los valores que toma $\rho_0(x)$, mientras no se cambie su valor en $x'_0$, el valor $\rho(x',t')$ permanecerá sin cambiar \cite{Leveque}. 

En el caso general, para cualquier sistema hiperbólico, el valor de la solución $\mathbf{U}$ en un punto $(x',t')$ depende únicamente de los valores que toma la función inicial $\mathbf{U}_0$ en un dominio $D(x',t')$ que corresponde a un intervalo \textbf{cerrado} \cite{Leveque}. Este último se denomina \textbf{dominio de dependencia} \cite{Leveque}. El tamaño de este intervalo usualmente crece a medida que avance el tiempo, sin embargo, el tamaño está acotado de la siguiente forma $D(x',t') = \{x : |x-x'| \leq a_{\text{máx}}t \}$ \cite{Leveque}. En resumen, las ecuaciones hiperbólicas poseen una velocidad finita de propagación; lo que significa que la información de la solución puede viajar a lo largo del espacio a una velocidad $a_{\text{máx}}$ como máximo \cite{Leveque}.

\section{Discontinuidades en soluciones}
Al derivar la forma diferencial de una ecuación de conservación (\ref{eq:integral-con-derivadas}) se enfatizó que era necesario exigir la diferenciabilidad de las cantidades conservadas. Sin embargo, si se toman en cuenta los atributos de la solución, proporcionados por las curvas características, de la ecuación de advección, resulta que el valor de la variable involucrada $\rho(x,t)$ depende únicamente del valor de la condición inicial en un punto $x_0$ tal que $x = x_0 + \alpha t$ \cite{Leveque}. Por esta última razón se puede concluir que, al menos para la ecuación de advección, es posible definir una solución sin exigirle que sea una función  suave \cite{Leveque}. La definición de una solución con singularidades surge gracias a que la forma integral de una ecuación de conservación sí se satisface con funciones no diferenciables, a diferencia de la forma diferencial \cite{Leveque}. También es importante hacer énfasis en que la forma integral de una ecuación de conservación tiene un significado físico más fundamental.

Si la condición inicial de una ecuación de conservación escalar $u_0(x)$ tiene una singularidad (discontinuidad en sí misma o en alguna derivada), en un punto $x_0$, entonces la solución de la ecuación, $u(x,t)$, también poseerá una singularidad del mismo orden en todos los puntos definidos por la característica que parte de $x_0$ \cite{Leveque}. Para los sistemas hiperbólicos en general, las singularidades se propagan a lo largo de las curvas características \cite{Leveque}.

A continuación se describen dos formas de definir las soluciones con singularidades:
\subsection{Viscosidad disipada}
Como se vio anteriormente algunas soluciones de las ecuaciones de conservación pueden poseer singularidades si la condición inicial de la ecuación tiene una singularidad. Para los sistemas hiperbólicos no lineales, las discontinuidades pueden formarse a lo largo de la evolución temporal de la solución \cite{Leveque}. A las singularidades que se desarrollan en las soluciones se les llama \textbf{ondas de choque} o \textbf{shocks} en inglés \cite{Cameron}. Para definir cómo estas funciones siguen siendo soluciones, en el sentido estricto de la palabra, se redefine la ecuación que deben satisfacer agregándole un coeficiente de viscosidad $\varepsilon$ que va acompañado del laplaciano de la variable involucrada \cite{Leveque}. En el caso de la ecuación de advección para $u$, se define la siguiente ecuación modificada
\begin{equation}
	u_t + \alpha u_x = \varepsilon u_{xx},
	\label{eq:advec-difus}
\end{equation}
donde $u_{xx} \equiv \pdv[2]{u}{x}$ \cite{Leveque}. A esta ecuación se le conoce como \textbf{ecuación de advección - difusión}, ya que el término viscoso también se denomina como término difusivo y está involucrado en la ecuación de difusión, también conocida como ecuación de calor \cite{heattransfer}. 

Si se denota a $u^{\varepsilon}(x,t)$ como la solución de la ecuación (\ref{eq:advec-difus}) con condición inicial $u_0(x)$, entonces $u^{\varepsilon} \in C^{\infty}(\mathbb{R} \times [0,\infty)) $ donde $ C^{\infty}(\mathbb{R}\times [0,\infty))$ es el conjunto de funciones infinitamente diferenciables (suaves) definidas en el mismo espacio en donde se resuelve la ecuación \cite{Leveque}. Esto se cumple incluso si $u_0(x)$ no es una función suave, ya que la ecuación (\ref{eq:advec-difus}) es de tipo parabólica \cite{Leveque}. Para encontrar la solución a la ecuación original (\ref{eq:adveccion}) se debe hacer el límite $\varepsilon \rightarrow 0$ en la solución de la ecuación de advección - difusión (\ref{eq:advec-difus}); a esta forma de definir una solución con discontinuidades se le denomina \textbf{solución con viscosidad disipada} \cite{Leveque}.
\subsection{Solución débil}
La otra forma de definir una solución con singularidades es definiendo una \textbf{solución débil} de la ecuación de conservación, haciendo uso de la forma integral de esta última \cite{Leveque}. Es evidente que la forma diferencial de la ecuación de conservación no se satisface con una función con singularidades ya que sus derivadas no están bien definidas en todo el dominio de la función. La idea del procedimiento de la definición de una solución débil es reescribir la ecuación en forma integral, trasladando las derivadas hacia una \textbf{función prueba}, que sí es una función diferenciable y así relajar las condiciones de suavidad para la función incógnita \cite{Leveque}.

Sea $\phi(x,t)$ una función continuamente diferenciable con \textbf{soporte compacto}, i.e., $\phi(x,t) \in C_{0}^{1} (\mathbb{R} \times [0, \infty))$. La tenencia de soporte compacto de la función significa que $\phi(x,t)$ es exactamente igual a cero fuera de algún conjunto cerrado, por lo que el soporte de la función yace en un subconjunto compacto del espacio $(x,t) = \mathbb{R} \times [0, \infty)$ \cite{Cameron}\cite{Leveque}.

Para definir la solución débil de la ecuación de conservación escalar $u_t + f(u)_x = 0$, esta se multiplica por la función $\phi$ descrita anteriormente:
\begin{equation}
	u_t + f(u)_x = 0
	\label{eq:conser-u}
\end{equation}
\begin{equation}
	\phi u_t + \phi f(u)_x = 0.
\end{equation}
Ahora, se integra sobre todo el espacio y el tiempo,
\begin{equation}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}\left(\phi u_t + \phi f(u)_x\right) \dd{x}\dd{t} = 0,
\end{equation}
luego, integrando por partes cada término de la integral, se obtiene
\begin{equation}
	\int_{-\infty}^{\infty}\int_{0}^{\infty} \phi u_t \dd{t}\dd{x} = \int_{-\infty}^{\infty}\int_{0}^{\infty} \left((\phi u)_t - \phi_t u\right) \dd{t}\dd{x}
\end{equation}
\begin{equation}
	\int_{-\infty}^{\infty}\int_{0}^{\infty} \phi u_t \dd{t}\dd{x} = \int_{-\infty}^{\infty} (\phi u) \Big|_{0}^{\infty}\dd{x} - \int_{-\infty}^{\infty}\int_{0}^{\infty}\phi_t u \dd{t}\dd{x}.
\end{equation}
Dado que $\phi$ tiene soporte compacto, es posible asegurarse que $\lim\limits_{t\rightarrow \infty}\phi(x,t) = 0$. Por tanto,
\begin{equation}
	\int_{-\infty}^{\infty}\int_{0}^{\infty} \phi u_t \dd{t}\dd{x} = 
	-\int_{-\infty}^{\infty} \phi(x,0)u(x,0) \dd{x} - \int_{-\infty}^{\infty}\int_{0}^{\infty}\phi_t u \dd{t}\dd{x}.
\end{equation}
Trabajando el segundo término, se tiene
\begin{equation}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}  \phi f(u)_x \dd{x}\dd{t} = 
	\int_{0}^{\infty}\int_{-\infty}^{\infty} \left((\phi f(u))_x - \phi_x f(u)\right) \dd{x}\dd{t}
\end{equation}
\begin{equation}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}  \phi f(u)_x \dd{x}\dd{t} = 
	\int_{0}^{\infty} \phi f(u) \Big|_{-\infty}^{\infty} \dd{t}  - \int_{0}^{\infty}\int_{-\infty}^{\infty} \phi_x f(u) \dd{x}\dd{t},
\end{equation}
de igual manera que con la valuación de la integral del término anterior, el soporte compacto de $\phi$ permite justificar que $\lim\limits_{x\rightarrow -\infty}\phi = 0 = \lim\limits_{x\rightarrow \infty}\phi$. Entonces,
\begin{equation}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}  \phi f(u)_x \dd{x}\dd{t} =  -\int_{0}^{\infty}\int_{-\infty}^{\infty} \phi_x f(u) \dd{x}\dd{t}.
\end{equation}
Por tanto, la integral de la ecuación de conservación multiplicada por la función prueba queda como
\begin{equation}
\begin{aligned}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}\left(\phi u_t + \phi f(u)_x\right) \dd{x}\dd{t} = \int_{-\infty}^{\infty} \phi(x,0)u(x,0) \dd{x} \\
	-\int_{0}^{\infty}\int_{-\infty}^{\infty}\left(\phi_t u + \phi_x f(u)\right) \dd{x}\dd{t} = 0.
\end{aligned}
\end{equation}
Por tanto, se obtiene la igualdad
\begin{equation}
	\int_{0}^{\infty}\int_{-\infty}^{\infty}\left(\phi_t u + \phi_x f(u)\right) \dd{x}\dd{t} = -\int_{-\infty}^{\infty} \phi(x,0)u(x,0) \dd{x},
	\label{eq:weak-equality}
\end{equation}
que tal y como se dijo previamente, las derivadas parciales ahora están siendo aplicadas a $\phi$ y la integral de la nueva ecuación diferencial se iguala a una integral que depende únicamente de las condiciones iniciales del problema a resolver para $u$. Entonces se dice que $u$ es una \textbf{solución débil} de la ecuación (\ref{eq:conser-u}) si y solo si se cumple la igualdad (\ref{eq:weak-equality}) para todo $\phi$ tal que $\phi(x,t) \in C_{0}^{1} (\mathbb{R} \times [0, \infty))$ \cite{Leveque}.

Es posible demostrar que la igualdad (\ref{eq:weak-equality}) es equivalente a la forma integral de la ecuación diferencial en cuestión (ecuación \ref{eq:continuidad-2-integral}), mediante la elección de una función de prueba que esta cumpla con la siguiente propiedad:
\begin{equation}
	\phi(x,t) = 
	\begin{cases}
		1 & \text{para } (x,t) \in [x_1, x_2] \times [t_1, t_2]\\
		0 & \text{para } (x,t) \notin [x_1 - \epsilon, x_2 + \epsilon] \times [t_1 - \epsilon, t_2 + \epsilon].
 	\end{cases}
\end{equation}
Además $\phi$ es una función suave en la banda intermedia con ancho $\epsilon$ \cite{Leveque}. Entonces al calcular la integral (\ref{eq:weak-equality})  se puede notar que esta se reduce a la integral sobre la banda $\epsilon$, a raíz de la propiedad expuesta anteriormente. Al calcular esta integral y haciendo el límite $\epsilon \rightarrow 0$, las derivadas $\phi_x$ y $\phi_t$ tienden a deltas de Dirac \footnote{La delta de Dirac $\delta(x)$ es una función generalizada que cumple con la siguiente propiedad $\int_{-\infty}^{\infty} \delta(x-a) f(x)\dd{x} = f(a)$ \cite{methods}.}, recuperando así los valores de $u$ y $ f(u)$ en las fronteras del dominio $ [x_1, x_2] \times [t_1, t_2]$ en integrales que equivalen a los términos de la ecuación de conservación en forma integral (\ref{eq:continuidad-2-integral})\cite{Leveque}. Cabe destacar que este es u esbozo solamente de la demostración, ya que esta requiere más rigor matemático. Sin embargo, lo imprescindible es destacar la equivalencia entre ambas expresiones.

\section{Ecuación de Burgers}
Se pueden destacar las propiedades más importantes de las ecuaciones de conservación no lineales de la mecánica de fluidos a través de un ejemplo escalar conocido como \textbf{ecuación de Burgers.} Esta ecuación tiene la siguiente forma:

\begin{equation}
	u_t + u u_x = 0,
	\label{eq:burgers}
\end{equation}
la cual es formalmente conocida como Ecuación de Burgers sin viscosidad \cite{Leveque}, pero en este texto se le referirá solamente como Ecuación de Burgers. Esta ecuación es un modelo muy simple de la velocidad $u$ de un gas \cite{Cameron}. La ecuación originalmente estudiada por Jan Burgers \cite{Leveque} contiene un término de viscosidad cinemática:
\begin{equation}
	u_t + u u_x = \varepsilon u_{xx},
	\label{eq:burgers-vis}
\end{equation}
donde $\varepsilon$ es el coeficiente de viscosidad cinemática. A esta última ecuación se le referirá como Ecuación de Burgers viscosa.

De la ecuación (\ref{eq:burgers}) podemos notar un ligero parecido a la ecuación de advección (\ref{eq:adveccion}), con la diferencia que la velocidad de advección $\alpha$ se reemplaza por la variable que sufre la advección, i.e., $u$ \cite{Leveque}, lo que brinda la naturaleza no lineal de este modelo. La ecuación de Burgers se puede escribir en forma conservativa:
\begin{equation}
	u_t + \left(\frac{1}{2}u^{2}\right)_x = 0.
	\label{eq:burgers-cons}
\end{equation}
A partir de esta forma, se puede concluir que la función de flujo es $f(u) = \frac{1}{2}u^{2}$.
\subsection{Curvas características}
Las curvas características de la ecuación de Burgers se pueden definir a través de la siguiente ecuación diferencial \cite{Leveque}
\begin{equation}
	x'(t) = u(x(t),t),
	\label{eq:burgers-char}
\end{equation}
dado que se puede recuperar la ecuación diferencial parcial derivando respecto al tiempo la velocidad:
\begin{equation}
	\dv{t} u(x(t),t) = \pdv{u}{t} + \pdv{u}{x} \dv{x}{t}
\end{equation}
\begin{equation}
	\dv{t} u(x(t),t) = \pdv{u}{t} + u\pdv{u}{x} = 0.
\end{equation}
Por lo tanto, $u$ es constante en el tiempo sobre cualquier característica. Se puede resolver la ecuación (\ref{eq:burgers-char}) utilizando este último hecho:
\begin{equation}
	x(t) = u(\xi,0)t + \xi
	\label{eq:burg-char-expr}
\end{equation}
y al resolver para $\xi$, es posible resolver la ecuación diferencial \cite{Leveque}
\begin{equation}
	u(x,t) = u(\xi, 0).
	\label{eq:sol-burgers-char}
\end{equation}
Es importante destacar que la expresión (\ref{eq:sol-burgers-char}) para $u(x,t)$ no es válida para todo $t$, dado que las características definidas por la ecuación (\ref{eq:burg-char-expr}) pueden intersectarse en algún momento. Esto se da si para algún $x$, se tiene que $u_0'(x) < 0$ \cite{Leveque}. 

\begin{figure}
	\begin{subfigure}{0.5\textwidth}
		\centering
		\includegraphics[width=\linewidth]{../some_plots/cond_inicial.pdf}
		\caption{Gráfica de $u(x,0) = \exp(-x^2)$.}
		\label{fig:subfig1}
	\end{subfigure}%
	\begin{subfigure}{0.5\textwidth}
		\centering
		\includegraphics[width=\linewidth]{../some_plots/caracteristicas_burgers.pdf}
		\caption{Características de la ecuación de Burgers.}
		\label{fig:subfig2}
	\end{subfigure}
	\caption{Gráficas de la condición inicial $u(x,0) = \exp(-x^2)$ para la ecuación de Burgers y de algunas características asociadas a esta condición inicial. \textbf{Fuente:} elaboración propia.}
	\label{fig:figura_completa}
\end{figure}
\subsection{Ondas de choque}
Como se puede observar en la figura (\ref{fig:subfig2}), las características asociadas a una condición inicial con forma gaussiana se intersectan. Entonces, si las características se intersectan, la expresión (\ref{eq:sol-burgers-char}) no está bien definida, sino que $u(x,t)$ puede tomar varios valores a la vez, cada uno correspondiente a una característica diferente. En el caso de la ecuación de Burgers, cuando las características se intersectan, la solución se convierte en una "función'' con tres valores distintos \cite{Leveque}. Esta solución puede tener sentido en algunos contextos, como en el caso del problema de agua superficial \cite{Leveque}. Sin embargo, en la mayoría de casos esta solución no tiene significado físico ya que la variable $u(x,t)$ representa una velocidad y esta debe devolver un solo valor \cite{Leveque}.

La solución 